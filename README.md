# LoanDocGenYOLO
This repository contains a set of Python scripts designed to automate the process of converting documents (PDFs) to images, detecting objects within those images using YOLOv8, and classifying the type of document based on OCR and embeddings generated by OpenAI's API.

## Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Installation](#installation)
- [Usage](#usage)
  - [PDF to Image Conversion](#pdf-to-image-conversion)
  - [Object Detection](#object-detection)
  - [Document Classification](#document-classification)
- [Folder Structure](#folder-structure)
- [Dependencies](#dependencies)
- [License](#license)

## Overview

The pipeline involves the following steps:
1. **Convert PDFs to images**: The `document_to_image.py` script converts PDF pages into images.
2. **Object Detection**: The `detection.py` script uses a YOLOv8 model to detect objects in the generated images.
3. **Document Classification**: The `validation_test.py` script classifies the type of document based on OCR data and embeddings generated using OpenAI's API.

## Features

- **PDF to Image Conversion**: Converts PDF pages into images using PyMuPDF and PIL.
- **Object Detection**: Detects objects in images using a pre-trained YOLOv8 model.
- **Document Classification**: Classifies document types using OCR and embeddings generated via OpenAI's text-embedding-ada-002 model.

## Installation

1. **Clone the repository**:
    ```bash
    git clone <repository-url>
    cd <repository-directory>
    ```

2. **Install the required dependencies**:
    ```bash
    pip install -r requirements.txt
    ```

3. **Set up OpenAI API key**:
    Replace `'your-openai-api-key'` in the `validation_test.py` file with your actual OpenAI API key.

4. **Install Tesseract (for OCR)**:
    On Ubuntu:
    ```bash
    sudo apt-get install tesseract-ocr
    ```

## Usage

### PDF to Image Conversion

This step involves converting each page of the PDFs into individual images.

- **Script**: `document_to_image.py`
- **Usage**: Update the `input_directory` and `output_directory` variables in the script with your paths. Then run:
    ```bash
    python document_to_image.py
    ```

### Object Detection

This step involves detecting objects within the images generated from the PDF files.

- **Script**: `detection.py`
- **Usage**: Update the `main_folder`, `output_folder`, and `completed_folder` variables with the appropriate paths. It will be automatically executed when you run document_to_image.py script.
    ```

### Document Classification

This step involves classifying the document type based on the OCR data extracted from the images.

- **Script**: `validation_test.py`
- **Usage**: Update the `train_dir` and `test_image_path` variables with the appropriate paths. Then run:
    ```bash
    python validation_test.py
    ```

## Folder Structure

- `/dirs/verified_documents`: Contains the PDF documents to be processed.
- `/dirs/main_output_folder`: Contains images generated from the PDFs.
- `/dirs/detections`: Contains the detected images.
- `/dirs/processed_documents`: Contains the processed documents moved after detection.
- `/dirs/train`: Contains the training data for document classification.

## Dependencies

- Python 3.7+
- PyMuPDF
- PIL (Pillow)
- OpenAI Python Client
- pytesseract
- pandas
- numpy
- ultralytics (YOLOv8)

To install all dependencies:
```bash
pip install -r requirements.txt
```
